<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>بوابة المطور - عالم سايبربانك</title>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0; padding: 0; width: 100vw; height: 100vh;
      overflow: hidden;
      background: #0a0020;
      font-family: 'Cairo', monospace, sans-serif;
      direction: rtl;
    }
    #threejs-canvas {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 1;
      display: block;
    }
    .overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; z-index: 10;
      pointer-events: none;
    }
    .headline-ar {
      position: absolute; top: 8vh; left: 50%; transform: translateX(-50%);
      font-size: 2.2rem; color: #39ff14;
      text-shadow: 0 0 24px #00fff7, 0 0 48px #a020f0;
      letter-spacing: 2px; z-index: 20; user-select: none;
      font-family: 'Cairo', monospace;
      animation: glitch 2.5s infinite linear alternate;
      text-align: center;
      white-space: pre-line;
    }
    @keyframes glitch {
      0% { text-shadow: 2px 0 #00fff7, -2px 0 #a020f0; }
      20% { text-shadow: -2px 2px #00fff7, 2px -2px #a020f0; }
      40% { text-shadow: 2px -2px #00fff7, -2px 2px #a020f0; }
      60% { text-shadow: 0 0 24px #00fff7, 0 0 48px #a020f0; }
      80% { text-shadow: 2px 2px #00fff7, -2px -2px #a020f0; }
      100% { text-shadow: 0 0 24px #00fff7, 0 0 48px #a020f0; }
    }
    .explore-tip {
      position: absolute; bottom: 6vh; left: 50%; transform: translateX(-50%);
      color: #fff; font-size: 1.1rem; opacity: 0.8; z-index: 30;
      background: rgba(0,0,0,0.4); padding: 8px 18px; border-radius: 12px;
      border: 1.5px solid #00fff7; box-shadow: 0 0 16px #00fff7;
      user-select: none;
      animation: fadeInUp 2s;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @media (max-width: 700px) {
      .headline-ar { font-size: 1.1rem; }
      .explore-tip { font-size: 0.9rem; padding: 6px 8px; }
    }
  </style>
</head>
<body>
  <canvas id="threejs-canvas"></canvas>
  <div class="overlay">
    <div class="headline-ar" id="headline-ar">مرحباً بك في عقل المطور
بوابة المستقبل البرمجية</div>
    <div class="explore-tip" id="explore-tip">يتم الدخول تلقائياً... انتظر لحظات</div>
  </div>
  <audio id="ambient-audio" src="https://cdn.pixabay.com/audio/2022/10/16/audio_12b6b6b6b6.mp3" loop autoplay style="display:none"></audio>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.153.0/examples/js/controls/OrbitControls.js"></script>
  <div id="webgl-error" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:#0a0020cc;color:#fff;z-index:9999;align-items:center;justify-content:center;font-size:1.5rem;text-align:center;">عذراً، متصفحك لا يدعم WebGL أو حدث خطأ في تحميل المشهد.<br>يرجى تحديث المتصفح أو تجربة متصفح آخر.</div>
  <script>
    // إعداد المشهد ثلاثي الأبعاد
    let scene, camera, renderer, controls, portal, portalGlow, portalParticles = [],
        skillPlanets = [], floatingText = [], panels = [], cityGroup, mixer, clock = new THREE.Clock();
    let entered = false;
    const canvas = document.getElementById('threejs-canvas');
    function initScene() {
      scene = new THREE.Scene();
      camera = new THREE.PerspectiveCamera(70, window.innerWidth/window.innerHeight, 0.1, 200);
      camera.position.set(0, 0, 18);
      renderer = new THREE.WebGLRenderer({canvas, alpha:true, antialias:true});
      renderer.setSize(window.innerWidth, window.innerHeight);
      renderer.setClearColor(0x0a0020, 1);
      // بوابة سحرية
      const portalGeo = new THREE.TorusGeometry(4.5, 0.55, 32, 120);
      const portalMat = new THREE.MeshPhysicalMaterial({
        color: 0x8f00ff,
        emissive: 0x00fff7,
        roughness: 0.2,
        metalness: 0.8,
        transmission: 0.7,
        thickness: 1.2,
        clearcoat: 1,
        ior: 1.5,
        transparent: true,
        opacity: 0.95
      });
      portal = new THREE.Mesh(portalGeo, portalMat);
      portal.position.set(0, 0, 0);
      scene.add(portal);
      // توهج البوابة
      const glowGeo = new THREE.TorusGeometry(4.7, 0.18, 32, 120);
      const glowMat = new THREE.MeshBasicMaterial({color:0x39ff14, transparent:true, opacity:0.45});
      portalGlow = new THREE.Mesh(glowGeo, glowMat);
      scene.add(portalGlow);
      // جزيئات كهربائية حول البوابة
      for(let i=0;i<60;i++){
        const pGeo = new THREE.SphereGeometry(Math.random()*0.09+0.04, 8, 8);
        const pMat = new THREE.MeshBasicMaterial({color:0xffffff, transparent:true, opacity:0.7});
        const p = new THREE.Mesh(pGeo, pMat);
        const angle = Math.random()*Math.PI*2;
        const radius = 4.7 + Math.random()*0.2;
        p.position.set(Math.cos(angle)*radius, Math.sin(angle)*radius, Math.random()*1-0.5);
        scene.add(p);
        portalParticles.push({mesh:p, base:angle, speed:Math.random()*0.02+0.01});
      }
      // إضاءة عامة
      scene.add(new THREE.AmbientLight(0x39ff14, 1.2));
      const point = new THREE.PointLight(0x00fff7, 2, 60);
      point.position.set(0,0,10);
      scene.add(point);
      // مؤثرات مدينة سايبربانك (مكعبات مضيئة)
      cityGroup = new THREE.Group();
      for(let i=0;i<40;i++){
        const geo = new THREE.BoxGeometry(Math.random()*0.7+0.3, Math.random()*2.5+1, Math.random()*0.7+0.3);
        const mat = new THREE.MeshStandardMaterial({color:0x2222ff + Math.floor(Math.random()*0x00ff00), emissive:0x00fff7, emissiveIntensity:0.7, metalness:0.7, roughness:0.3});
        const mesh = new THREE.Mesh(geo, mat);
        mesh.position.set(Math.random()*30-15, -4.5, Math.random()*-18-6);
        mesh.castShadow = mesh.receiveShadow = true;
        cityGroup.add(mesh);
      }
      scene.add(cityGroup);
      // كواكب المهارات
      const skills = [
        {name:'جافاسكريبت', color:0xf7df1e},
        {name:'بايثون', color:0x3776ab},
        {name:'سي شارب', color:0x178600},
        {name:'تايب سكريبت', color:0x3178c6},
        {name:'ريأكت', color:0x61dafb},
        {name:'ثري جي إس', color:0x00fff7},
        {name:'CSS', color:0x264de4},
        {name:'Node.js', color:0x3c873a}
      ];
      for(let i=0;i<skills.length;i++){
        const geo = new THREE.SphereGeometry(0.7, 24, 24);
        const mat = new THREE.MeshStandardMaterial({color:skills[i].color, emissive:skills[i].color, emissiveIntensity:0.5, metalness:0.7, roughness:0.3});
        const planet = new THREE.Mesh(geo, mat);
        planet.position.set(Math.cos(i/skills.length*Math.PI*2)*7, Math.sin(i/skills.length*Math.PI*2)*3.5, -2.5+Math.sin(i)*2);
        planet.userData = {lang: skills[i].name};
        scene.add(planet);
        skillPlanets.push(planet);
      }
      // نصوص ثلاثية الأبعاد (اسم المطور وألقاب)
      // (للتبسيط: سنستخدم لوحات مضيئة بدلاً من TextGeometry)
      const namePanel = makePanel('يحيى رضا', 2.2, 0x39ff14, 0, 2.7, 2.5);
      const titlePanel = makePanel('مطور ويب | مبرمج خيال علمي', 1.3, 0x00fff7, 0, 1.2, 2.5);
      floatingText.push(namePanel, titlePanel);
      // لوحات تفاعلية (مشاريع، تواصل، خبرات)
      panels.push(makePanel('مشروع: بوابة المطور', 1.1, 0xff00ff, -4, -1.5, 1.5));
      panels.push(makePanel('تواصل: @yahya.dev', 1.1, 0x00fff7, 4, -1.5, 1.5));
      panels.push(makePanel('الخبرات: 2017-2025', 1.1, 0x39ff14, 0, -3.2, 1.5));
      // دخان وجزيئات (مؤثرات إضافية)
      // ... يمكن إضافة مؤثرات smoke/particles هنا لاحقاً ...
      // تحكم الكاميرا
      controls = new THREE.OrbitControls(camera, renderer.domElement);
      controls.enablePan = false;
      controls.enableZoom = false;
      controls.enableDamping = true;
      controls.dampingFactor = 0.08;
      controls.autoRotate = false;
      // تفاعل parallax
      document.addEventListener('mousemove', (e) => {
        if(!entered) return;
        const x = (e.clientX/window.innerWidth - 0.5)*2;
        const y = (e.clientY/window.innerHeight - 0.5)*2;
        camera.position.x = x*2;
        camera.position.y = -y*1.5;
        camera.lookAt(0,0,0);
      });
      animate();
    }
    // دالة إنشاء لوحة نصية مضيئة
    function makePanel(text, size, color, x, y, z) {
      const canvas = document.createElement('canvas');
      canvas.width = 512; canvas.height = 128;
      const ctx = canvas.getContext('2d');
      ctx.font = `bold ${Math.floor(size*38)}px Cairo, monospace`;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';
      ctx.shadowColor = '#00fff7';
      ctx.shadowBlur = 18;
      ctx.fillStyle = '#fff';
      ctx.fillText(text, 256, 64);
      const tex = new THREE.CanvasTexture(canvas);
      const mat = new THREE.MeshBasicMaterial({map:tex, transparent:true, color:color});
      const geo = new THREE.PlaneGeometry(size*3, size*0.8);
      const mesh = new THREE.Mesh(geo, mat);
      mesh.position.set(x, y, z);
      scene.add(mesh);
      return mesh;
    }
    // حركة الدخول عبر البوابة
    function enterPortal() {
      if(entered) return;
      entered = true;
      let t = 0;
      const startZ = camera.position.z;
      const endZ = 2.5;
      const anim = () => {
        t += 0.045; // تسريع الحركة
        camera.position.z = startZ + (endZ-startZ)*Math.sin(Math.PI/2*t);
        camera.lookAt(0,0,0);
        if(t < 1) requestAnimationFrame(anim);
        else {
          controls.autoRotate = true;
          document.getElementById('explore-tip').style.display = 'none';
        }
      };
      anim();
      // تشغيل الصوت
      document.getElementById('ambient-audio').play();
    }
    // رسم المشهد وتحديث المؤثرات
    function animate() {
      requestAnimationFrame(animate);
      // توهج البوابة
      portalGlow.material.color.setHSL((Date.now()/2000)%1, 1, 0.6);
      portal.material.color.setHSL((Date.now()/3000)%1, 1, 0.5);
      // جزيئات كهربائية
      portalParticles.forEach((p,i)=>{
        p.mesh.position.x = Math.cos(p.base + Date.now()*p.speed/60)*4.7;
        p.mesh.position.y = Math.sin(p.base + Date.now()*p.speed/60)*4.7;
        p.mesh.material.opacity = 0.5 + 0.5*Math.sin(Date.now()/400 + i);
      });
      // دوران الكواكب
      skillPlanets.forEach((p,i)=>{
        p.rotation.y += 0.01 + i*0.002;
        p.position.x += Math.sin(Date.now()/900 + i)*0.002;
        p.position.y += Math.cos(Date.now()/1100 + i)*0.002;
      });
      // دوران النصوص
      floatingText.forEach((panel,i)=>{
        panel.rotation.y = Math.sin(Date.now()/1200 + i)*0.2;
        panel.position.x += Math.sin(Date.now()/1300 + i)*0.0015;
      });
      // دوران المدينة
      cityGroup.rotation.y = Math.sin(Date.now()/4000)*0.08;
      controls.update();
      renderer.render(scene, camera);
    }
    // استجابة تغيير الحجم
    window.addEventListener('resize', ()=>{
      if(renderer && camera){
        renderer.setSize(window.innerWidth, window.innerHeight);
        camera.aspect = window.innerWidth/window.innerHeight;
        camera.updateProjectionMatrix();
      }
    });
    // التحقق من دعم WebGL
    function checkWebGL() {
      try {
        const canvas = document.createElement('canvas');
        return !!window.WebGLRenderingContext && (
          canvas.getContext('webgl') || canvas.getContext('experimental-webgl')
        );
      } catch(e) { return false; }
    }
    // دخول البوابة عند التحميل أو التفاعل
    window.addEventListener('DOMContentLoaded', ()=>{
      if(!checkWebGL()) {
        document.getElementById('webgl-error').style.display = 'flex';
        return;
      }
      initScene();
      enterPortal();
    });
    document.body.addEventListener('click', enterPortal);
    document.body.addEventListener('touchstart', enterPortal);
    document.body.addEventListener('wheel', enterPortal);
  </script>
</body>
</html>
