<canvas id="explosion-canvas" style="position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:9999;pointer-events:none;display:none;"></canvas>
<script>
  // مؤثر انفجار Matrix/هكر متقن عند الحفظ أو عند الضغط على زر معين
  function triggerExplosion(x, y) {
    const canvas = document.getElementById('explosion-canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    canvas.style.display = 'block';
    const particles = [];
    const colors = ['#00ff41','#baffc9','#00fff7','#39ff14','#00bfff','#fff'];
    for(let i=0;i<120;i++){
      const angle = Math.random()*2*Math.PI;
      const speed = 6+Math.random()*8;
      particles.push({
        x:x||window.innerWidth/2,
        y:y||window.innerHeight/2,
        vx:Math.cos(angle)*speed,
        vy:Math.sin(angle)*speed,
        r:2+Math.random()*3,
        color:colors[Math.floor(Math.random()*colors.length)],
        alpha:1
      });
    }
    let frame=0;
    function animate(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      for(const p of particles){
        ctx.save();
        ctx.globalAlpha = p.alpha;
        ctx.shadowColor = p.color;
        ctx.shadowBlur = 18;
        ctx.beginPath();
        ctx.arc(p.x,p.y,p.r,0,2*Math.PI);
        ctx.fillStyle = p.color;
        ctx.fill();
        ctx.restore();
        p.x += p.vx;
        p.y += p.vy;
        p.vx *= 0.93;
        p.vy *= 0.93;
        p.alpha -= 0.018+Math.random()*0.01;
      }
      frame++;
      if(frame<60) requestAnimationFrame(animate);
      else canvas.style.display = 'none';
    }
    animate();
  }
  // انفجار عند الحفظ
  document.getElementById('settingsForm').addEventListener('submit',function(e){
    setTimeout(()=>triggerExplosion(window.innerWidth/2,window.innerHeight/2),200);
  });
  // انفجار عند الضغط على الكارت
  document.querySelector('.settings-card').addEventListener('click',function(e){
    const rect = this.getBoundingClientRect();
    triggerExplosion(rect.left+rect.width/2,rect.top+rect.height/2);
  });
  // انفجار عند الضغط على المعاينة
  document.getElementById('livePreviewCard').addEventListener('click',function(e){
    const rect = this.getBoundingClientRect();
    triggerExplosion(rect.left+rect.width/2,rect.top+rect.height/2);
  });
</script>